var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},egret;!function(t){var e=function(e){function i(t){void 0===t&&(t=null);var i=e.call(this)||this;return i._transformDirty=!0,i._color={r:1,g:1,b:1,a:1},i._bkNode=t||new BK.Node,i}return __extends(i,e),i.prototype._replaceNode=function(t){this._transformDirty=!0,t.vertexColor=this._color,t.hidden=!this.visible,this._bkNode.parent&&(this._bkNode.parent.addChild(t,this.parent.getChildIndex(this)),this._bkNode.parent.removeChild(this._bkNode)),t.zOrder=this._bkNode.zOrder,this._bkNode=t},i.prototype.$setVisible=function(t){e.prototype.$setVisible.call(this,t),this._bkNode.hidden=!t},i.prototype.$setAlpha=function(t){e.prototype.$setAlpha.call(this,t),this._color.a=t,this._bkNode.vertexColor=this._color},Object.defineProperty(i.prototype,"blendMode",{set:function(e){var i=this,r=t.sys.blendModeToNumber(e);switch(i.$blendMode=r,e){case t.BlendMode.NORMAL:this._bkNode.blendMode=1;break;case t.BlendMode.ADD:this._bkNode.blendMode=0;break;case t.BlendMode.ERASE:}},enumerable:!0,configurable:!0}),i.prototype.$setX=function(t){var e=this;return e.$x==t?!1:(e.$x=t,this._transformDirty=!0,!0)},i.prototype.$setY=function(t){var e=this;return e.$y==t?!1:(e.$y=t,this._transformDirty=!0,!0)},i.prototype.$hitTest=function(t,e){var i=this;if(!i.$visible)return null;var r=i.$getInvertedConcatenatedMatrix();if(0==r.a&&0==r.b&&0==r.c&&0==r.d)return null;var n=i.$getContentBounds(),s=r.a*t+r.c*e+r.tx,o=r.b*t+r.d*e+r.ty;if(n.contains(s,o)){if(!i.$children){var h=i.$scrollRect?i.$scrollRect:i.$maskRect;if(h&&!h.contains(s,o))return null;if(i.$mask&&!i.$mask.$hitTest(t,e))return null}return i}return null},i.prototype.$getRenderNode=function(){if(this._transformDirty||this.$matrixDirty){this._transformDirty=!1;var t=this.$getMatrix(),e=this._bkNode.transform.matrix,i=t.tx,r=t.ty,n=this.$anchorOffsetX,s=this.$anchorOffsetY;(0!==n||0!==s)&&(i-=t.a*n+t.c*s,r-=t.b*n+t.d*s),e.set(t.a,-t.b,-t.c,t.d,i,-r)}return this._bkNode},i.prototype.$onAddToStage=function(i,r){e.prototype.$onAddToStage.call(this,i,r);var n=t.BKPlayer.instance._displayList.indexOf(this);0>n&&t.BKPlayer.instance._displayList.push(this)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var i=t.BKPlayer.instance._displayList.indexOf(this);i>=0&&t.BKPlayer.instance._displayList.splice(i,1)},i}(t.DisplayObject);t.BKDisplayObject=e,__reflect(e.prototype,"egret.BKDisplayObject"),t.DisplayObject=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this,new BK.ClipRectNode(0,-2048,2048,2048))||this;return t.$touchChildren=!0,t._bkClipRectNode=t._bkNode,t._bkClipRectNode.enableClip=!1,t.$children=[],t}return __extends(i,e),Object.defineProperty(i.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},i.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},i.prototype.$doAddChild=function(e,i,r){void 0===r&&(r=!0);var n=this,s=e.$parent;if(s==n)return n.doSetChildIndex(e,i),e;s&&s.removeChild(e),n.$children.splice(i,0,e),e.$setParent(n);var o=n.$stage;if(o&&e.$onAddToStage(o,n.$nestLevel+1),r&&e.dispatchEventWith(t.Event.ADDED,!0),o)for(var h=t.DisplayObjectContainer.$EVENT_ADD_TO_STAGE_LIST;h.length;){var a=h.shift();a.$stage&&r&&a.dispatchEventWith(t.Event.ADDED_TO_STAGE)}this._bkNode.addChild(e._bkNode,i);for(var l=0,u=this.$children.length;u>l;l++)this.$children[l]._bkNode.zOrder=-l;return this.$childAdded(e,i),e},i.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},i.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},i.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},i.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;r>n;n++)if(e=i[n],e.name==t)return e;return null},i.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},i.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},i.prototype.$doRemoveChild=function(e,i){void 0===i&&(i=!0),e=0|+e;var r=this.$children,n=r[e];if(this.$childRemoved(n,e),i&&n.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){n.$onRemoveFromStage();for(var s=t.DisplayObjectContainer.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var o=s.shift();i&&o.$hasAddToStage&&(o.$hasAddToStage=!1,o.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),o.$hasAddToStage=!1,o.$stage=null}}this.$displayList||this.$parentDisplayList;n.$setParent(null);var h=r.indexOf(n);return-1!=h&&r.splice(h,1),this._bkNode.removeChild(n._bkNode),n},i.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},i.prototype.doSetChildIndex=function(t,e){var i=this.$children.indexOf(t);if(i!=e){this.$childRemoved(t,i),this.$children.splice(i,1),this.$children.splice(e,0,t),this.$childAdded(t,e),this._bkNode.removeChild(t._bkNode),this._bkNode.addChild(t._bkNode,e);for(var r=0,n=this.$children.length;n>r;r++)this.$children[r]._bkNode.zOrder=-r}},i.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},i.prototype.swapChildren=function(t,e){var i=this.$children.indexOf(t),r=this.$children.indexOf(e);-1==i||-1==r||this.doSwapChildrenAt(i,r)},i.prototype.doSwapChildrenAt=function(t,e){if(t>e){var i=e;e=t,t=i}else if(t==e)return;var r=this.$children,n=r[t],s=r[e];this.$childRemoved(n,t),this.$childRemoved(s,e),r[t]=s,r[e]=n,this.$childAdded(s,t),this.$childAdded(n,e),s._bkNode.zOrder=-t,n._bkNode.zOrder=-e},i.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},i.prototype.$childAdded=function(t,e){},i.prototype.$childRemoved=function(t,e){},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i);var r=this.$children,n=r.length;i++;for(var s=0;n>s;s++){var o=this.$children[s];o.$onAddToStage(t,i)}},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,i=t.length,r=0;i>r;r++){var n=t[r];n.$onRemoveFromStage()}},i.prototype.$measureChildBounds=function(e){var i=this.$children,r=i.length;if(0!=r){for(var n=0,s=0,o=0,h=0,a=!1,l=-1;r>l;l++){var u=-1==l?e:i[l].$getTransformedBounds(this,t.$TempRectangle);u.isEmpty()||(a?(n=Math.min(n,u.x),s=Math.max(s,u.x+u.width),o=Math.min(o,u.y),h=Math.max(h,u.y+u.height)):(a=!0,n=u.x,s=n+u.width,o=u.y,h=o+u.height))}e.setTo(n,o,s-n,h-o)}},Object.defineProperty(i.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchChildren=function(){return this.$touchChildren},i.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},i.prototype.$hitTest=function(t,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*i+r.tx,s=r.b*t+r.d*i+r.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,s))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;for(var h=this.$children,a=!1,l=null,u=h.length-1;u>=0;u--){var d=h[u];if(!d.$maskedObject&&(l=d.$hitTest(t,i))){if(a=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:a?this:e.prototype.$hitTest.call(this,t,i)},Object.defineProperty(i.prototype,"scrollRect",{set:function(e){var i=this;(e||i.$scrollRect)&&(this._transformDirty=!0,e?(i.$scrollRect||(i.$scrollRect=new t.Rectangle,this._bkClipRectNode.enableClip=!0),i.$scrollRect.copyFrom(e),this._bkClipRectNode.clipRegion={x:i.$scrollRect.x,y:-i.$scrollRect.y-i.$scrollRect.height,width:i.$scrollRect.width,height:i.$scrollRect.height}):(i.$scrollRect=null,this._bkClipRectNode.enableClip=!1))},enumerable:!0,configurable:!0}),i.prototype.$getRenderNode=function(){if(this._transformDirty||this.$matrixDirty){this._transformDirty=!1;var t=this.$getMatrix(),e=this._bkNode.transform.matrix,i=t.tx,r=t.ty,n=this.$anchorOffsetX,s=this.$anchorOffsetY;(0!==n||0!==s)&&(i-=t.a*n+t.c*s,r-=t.b*n+t.d*s),this.$scrollRect&&(i-=this.$scrollRect.x,r-=this.$scrollRect.y),e.set(t.a,-t.b,-t.c,t.d,i,-r)}return this._bkNode},i.$EVENT_ADD_TO_STAGE_LIST=[],i.$EVENT_REMOVE_FROM_STAGE_LIST=[],i}(t.BKDisplayObject);t.BKDisplayObjectContainer=e,__reflect(e.prototype,"egret.BKDisplayObjectContainer"),t.DisplayObjectContainer=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r==this&&(r=this.$graphics.$hitTest(t,i)),r},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.BKDisplayObject);t.BKShape=e,__reflect(e.prototype,"egret.BKShape"),t.Shape=e}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.surface={},this.context={}}return Object.defineProperty(t.prototype,"width",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e,i){},t.prototype.getPixels=function(t,e,i,r){return void 0===i&&(i=1),void 0===r&&(r=1),[]},t.prototype.toDataURL=function(t,e){return""},t.prototype.clear=function(){},t.prototype.destroy=function(){},t}();t.BKRenderBuffer=e,__reflect(e.prototype,"egret.BKRenderBuffer",["egret.sys.RenderBuffer"]),t.sys.RenderBuffer=e}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.prototype.render=function(t,e,i,r){return 0},t.prototype.drawNodeToBuffer=function(t,e,i,r){},t}();t.BKSystemRenderer=e,__reflect(e.prototype,"egret.BKSystemRenderer",["egret.sys.SystemRenderer"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.width=0,i.height=0,i.source="",i.bkTexture=null,i.source=e,"string"==typeof i.source&&(i.bkTexture=new BK.Texture(i.source),i.width=i.bkTexture.size.width,i.height=i.bkTexture.size.height),i}return __extends(e,t),e.$invalidate=function(){},e}(t.HashObject);t.BKBitmapData=e,__reflect(e.prototype,"egret.BKBitmapData"),t.BitmapData=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._url="",t._method="",t.urlData={},t.responseHeader="",t}return __extends(i,e),Object.defineProperty(i.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"response",{get:function(){return this._response},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),i.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e},i.prototype.send=function(e){var i=this;if(i.isNetUrl(i._url)){this._bkHttpRequest=new BK.HttpUtil(this._url);var r=void 0;this._method===t.HttpMethod.GET?r="get":this._method===t.HttpMethod.POST&&(r="post"),this._bkHttpRequest.setHttpMethod(r),this._method===t.HttpMethod.POST&&this._bkHttpRequest.setHttpPostData(e),this._bkHttpRequest.setHttpCookie(e),this._bkHttpRequest.requestAsync(function(e,r){200===Number(r)?(i._responseType===t.HttpResponseType.ARRAY_BUFFER?i._response=t.bricksBufferToArrayBuffer(e):i._response=e.readAsString()||"",t.$callAsync(t.Event.dispatchEvent,t.Event,i,t.Event.COMPLETE)):(t.$warn(1019,r),t.Event.dispatchEvent(i,t.IOErrorEvent.IO_ERROR))})}else if(BK.FileUtil.isFileExist(i._url)){var n=BK.FileUtil.readFile(i._url);i._responseType===t.HttpResponseType.ARRAY_BUFFER?i._response=t.bricksBufferToArrayBuffer(n):i._response=n.readAsString()||"",t.$callAsync(t.Event.dispatchEvent,t.Event,i,t.Event.COMPLETE)}else t.$callAsync(t.Event.dispatchEvent,t.IOErrorEvent,i,t.IOErrorEvent.IO_ERROR)},i.prototype.isNetUrl=function(t){return-1!=t.indexOf("http://")||-1!=t.indexOf("HTTP://")||-1!=t.indexOf("https://")||-1!=t.indexOf("HTTPS://")},i.prototype.abort=function(){},i.prototype.onResponseHeader=function(t){this.responseHeader="";var e=JSON.parse(t);for(var i in e)this.responseHeader+=i+": "+e[i]+"\r\n"},i.prototype.getAllResponseHeaders=function(){return this.responseHeader},i.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},i.prototype.getResponseHeader=function(t){return""},i}(t.EventDispatcher);t.BKHttpRequest=e,__reflect(e.prototype,"egret.BKHttpRequest",["egret.HttpRequest"]),t.HttpRequest=e}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.prototype.addCallBacks=function(t,e,i,r,n){this.onConnect=t,this.onClose=e,this.onSocketData=i,this.onError=r,this.thisObject=n},e.prototype.connect=function(t,e){var i=t+":"+e;this.connectByUrl(i)},e.prototype.connectByUrl=function(t){this.$websocket=new BK.WebSocket(t),this.$websocket.connect(),this._bindEvent()},e.prototype._bindEvent=function(){var e=this,i=this.$websocket;i.onOpen=function(t){e.onConnect&&e.onConnect.call(e.thisObject)},i.onClose=function(t){e.onClose&&e.onClose.call(e.thisObject)},i.onError=function(t){e.onError&&e.onError.call(e.thisObject)},i.onMessage=function(i,r){if(e.onSocketData){var n=void 0;if(r.isBinary){var s=r.data;n=t.bricksBufferToArrayBuffer(s)}else n=r.data.readAsString();e.onSocketData.call(e.thisObject,n)}}},e.prototype.send=function(e){if("string"==typeof e)this.$websocket.send(e);else if(e instanceof ArrayBuffer){var i=new t.ByteArray(e),r=i.readUTF(),n=new BK.Buffer(r.length);n.writeAsString(r),this.$websocket.send(n)}},e.prototype.resHandler=function(e){switch(e.type){case t.Event.COMPLETE:var i=e.currentTarget;i.response;console.log()}},e.prototype.close=function(){this.$websocket.close()},e.prototype.disconnect=function(){},e}();t.BKSocket=e,__reflect(e.prototype,"egret.BKSocket",["egret.ISocket"]),t.ISocket=e}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._contentWidth=0,this._contentHeight=0,this._size={width:0,height:0},this._rawGrid=new t.Rectangle,this._grid=new t.Rectangle,this._leftTop=new BK.Sprite(0,0,{},0,1,1,1),this._centerTop=new BK.Sprite(0,0,{},0,1,1,1),this._rightTop=new BK.Sprite(0,0,{},0,1,1,1),this._leftCenter=new BK.Sprite(0,0,{},0,1,1,1),this._centerCenter=new BK.Sprite(0,0,{},0,1,1,1),this._rightCenter=new BK.Sprite(0,0,{},0,1,1,1),this._leftBottom=new BK.Sprite(0,0,{},0,1,1,1),this._centerBottom=new BK.Sprite(0,0,{},0,1,1,1),this._rightBottom=new BK.Sprite(0,0,{},0,1,1,1),this.__nativeObj=new BK.Node,t.defineProxyProperties(this.__nativeObj,this),this.__nativeObj.addChild(this._leftTop),this.__nativeObj.addChild(this._centerTop),this.__nativeObj.addChild(this._rightTop),this.__nativeObj.addChild(this._leftCenter),this.__nativeObj.addChild(this._centerCenter),this.__nativeObj.addChild(this._rightCenter),this.__nativeObj.addChild(this._leftBottom),this.__nativeObj.addChild(this._centerBottom),this.__nativeObj.addChild(this._rightBottom)}return e.prototype._updateGrid=function(){this._grid.x=this._rawGrid.x,this._grid.y=this._rawGrid.y,this._grid.width=this._contentWidth-this._rawGrid.x-this._rawGrid.width,this._grid.height=this._contentHeight-this._rawGrid.y-this._rawGrid.height},e.prototype.dispose=function(){this.__nativeObj.dispose()},e.prototype.setTexture=function(t){this._leftTop.setTexture(t),this._centerTop.setTexture(t),this._rightTop.setTexture(t),this._leftCenter.setTexture(t),this._centerCenter.setTexture(t),this._rightCenter.setTexture(t),this._leftBottom.setTexture(t),this._centerBottom.setTexture(t),this._rightBottom.setTexture(t)},e.prototype.setScale9Grid=function(t){this._rawGrid.setTo(t.x,t.y,t.width,t.height),this._updateGrid()},e.prototype.adjustTexturePosition=function(t,e,i,r,n){this._contentWidth=i,this._contentHeight=r,this._updateGrid();var s=this._grid.x,o=this._grid.y,h=this._grid.width,a=this._grid.height,l=i-s-h,u=r-o-a;if(n===!0);else{var d=t,c=t+s,p=t+(i-h),f=e,g=e+a,y=e+(r-o);this._leftTop.adjustTexturePosition(d,y,s,o),this._centerTop.adjustTexturePosition(c,y,l,o),this._rightTop.adjustTexturePosition(p,y,h,o),this._leftCenter.adjustTexturePosition(d,g,s,u),this._centerCenter.adjustTexturePosition(c,g,l,u),this._rightCenter.adjustTexturePosition(p,g,h,u),this._leftBottom.adjustTexturePosition(d,f,s,a),this._centerBottom.adjustTexturePosition(c,f,l,a),this._rightBottom.adjustTexturePosition(p,f,h,a)}},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){var e=this._size.width=t.width,i=this._size.height=t.height,r=this._grid.x,n=this._grid.y,s=this._grid.width,o=this._grid.height;if(r+s>e){var h=.5*(r+s-e);r-=h,s-=h}if(n+o>i){var a=.5*(n+o-i);n-=a,o-=a}var l=e-r-s,u=i-n-o;this._leftTop.position={x:0,y:o+u},this._centerTop.position={x:r,y:o+u},this._rightTop.position={x:r+l,y:o+u},this._leftCenter.position={x:0,y:o},this._centerCenter.position={x:r,y:o},this._rightCenter.position={x:r+l,y:o},this._leftBottom.position={x:0,y:0},this._centerBottom.position={x:r,y:0},this._rightBottom.position={x:r+l,y:0},this._leftTop.size={width:r+1,height:n+1},this._centerTop.size={width:l+1,height:n+1},this._rightTop.size={width:s,height:n+1},this._leftCenter.size={width:r+1,height:u+1},this._centerCenter.size={width:l+1,height:u+1},this._rightCenter.size={width:s,height:u+1},this._leftBottom.size={width:r+1,height:o},this._centerBottom.size={width:l+1,height:o},this._rightBottom.size={width:s,height:o}},enumerable:!0,configurable:!0}),e}();t.BKSprite9=e,__reflect(e.prototype,"egret.BKSprite9")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t){void 0===t&&(t=null);var i=e.call(this,new BK.Sprite(0,0,{},0,1,1,1))||this;return i.$explicitBitmapWidth=0/0,i.$explicitBitmapHeight=0/0,i._size={width:0,height:0},i.$bitmapData=null,i.$texture=null,i.$scale9Grid=null,i._bkSprite=i._bkNode,i.texture=t,i}return __extends(i,e),Object.defineProperty(i.prototype,"texture",{get:function(){return this.$texture},set:function(t){this.$texture!==t&&this.$setTexture(t)},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(t){this.$texture=t,this._transformDirty=!0,this.$texture?(this.$bitmapData=this.$texture.bitmapData,this.$bitmapData.bkTexture?(this._bkSprite.setTexture(this.$bitmapData.bkTexture),this._bkSprite.adjustTexturePosition(this.$texture.$bitmapX,this.$texture.$sourceHeight-(this.$texture.$bitmapY+this.$texture.$bitmapHeight),this.$texture.$bitmapWidth,this.$texture.$bitmapHeight,this.$texture.$rotated),this._size.width=this.$texture.$bitmapWidth,this._size.height=this.$texture.$bitmapHeight,this._bkSprite.size=this._size):(this.$bitmapData=null,this._bkSprite.setTexture({}))):(this.$bitmapData=null,this._bkSprite.setTexture({}))},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),i.prototype.$setScale9Grid=function(e){var i=this;i.$scale9Grid!=e&&(i.$scale9Grid?e?this._bkSprite.setScale9Grid(e):(this._bkSprite=new BK.Sprite(0,0,{},0,1,1,1),this._replaceNode(this._bkSprite),this.$setTexture(this.$texture)):e&&(this._bkSprite=new t.BKSprite9,this._replaceNode(this._bkSprite),this._bkSprite.setScale9Grid(e),this.$setTexture(this.$texture)),this._bkSprite.size=this._size,i.$scale9Grid=e,i.$renderDirty=!0)},i.prototype.$setWidth=function(t){var e=this;return 0>t||t==e.$explicitBitmapWidth?!1:(e.$explicitBitmapWidth=t,this._transformDirty=!0,this._size.width=t,this._bkSprite.size=this._size,!0)},i.prototype.$setHeight=function(t){var e=this;return 0>t||t==e.$explicitBitmapHeight?!1:(e.$explicitBitmapHeight=t,this._transformDirty=!0,this._size.height=t,this._bkSprite.size=this._size,!0)},i.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},i.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},i.prototype.$measureContentBounds=function(t){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$texture.$getTextureWidth():this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$texture.$getTextureHeight():this.$explicitBitmapHeight;t.setTo(0,0,e,i)}else{var e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight;t.setTo(0,0,e,i)}},i.prototype.$getRenderNode=function(){if(this._transformDirty||this.$matrixDirty){this._transformDirty=!1;var t=this.$getMatrix(),e=this._bkNode.transform.matrix,i=t.tx,r=t.ty,n=this.$anchorOffsetX,s=this.$anchorOffsetY-this._size.height;(0!==n||0!==s)&&(i-=t.a*n+t.c*s,r-=t.b*n+t.d*s),e.set(t.a,-t.b,-t.c,t.d,i,-r)}return this._bkNode||null},i}(t.BKDisplayObject);t.BKBitmap=e,__reflect(e.prototype,"egret.BKBitmap"),t.Bitmap=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this,new BK.Mesh(t.emptyTexture,[{x:0,y:0,z:0,r:1,g:1,b:1,a:1,u:0,v:1},{x:0,y:0,z:0,r:1,g:1,b:1,a:1,u:1,v:1},{x:0,y:-0,z:0,r:1,g:1,b:1,a:1,u:0,v:0}],[0,1,2]))||this;return i._textureDirty=!0,i._verticesDirty=!0,i._boundsDirty=!0,i._bounds=new t.Rectangle,i.$bitmapData=null,i.$texture=null,i.$renderNode=new t.sys.MeshNode,i._bkMesh=i._bkNode,i}return __extends(i,e),Object.defineProperty(i.prototype,"texture",{get:function(){return this.$texture},set:function(t){this.$texture!==t&&this.$setTexture(t)},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(t){this.$texture=t,this._transformDirty=!0,this.$texture?(this.$bitmapData=this.$texture.bitmapData,this.$bitmapData.bkTexture?this._bkMesh.setTexture(this.$bitmapData.bkTexture):(this.$bitmapData=null,this._bkMesh.setTexture({}))):(this.$bitmapData=null,this._bkMesh.setTexture({}))},i.prototype.$updateVertices=function(){this._verticesDirty=!0,this._boundsDirty=!0,this.$renderNode=new t.sys.MeshNode},i.prototype.$measureContentBounds=function(t){if(this._boundsDirty){this._boundsDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0,n=i.length;n>r;r+=2){var s=i[r],o=i[r+1];this._bounds.x>s&&(this._bounds.x=s),this._bounds.width<s&&(this._bounds.width=s),this._bounds.y>o&&(this._bounds.y=o),this._bounds.height<o&&(this._bounds.height=o)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i.prototype.$getRenderNode=function(){if(this._verticesDirty){this._verticesDirty=!1;var t=this.$renderNode,e=t.vertices,i=t.uvs,r=this._bkMesh.getVertices();if(r||(r=[]),r.length!==e.length/2){for(var n=r.length,s=e.length/2;s>n;++n)r[n]={};for(var o=this.$texture.$rotated,h=this.$texture.$bitmapX,a=this.$texture.$bitmapY,l=this.$texture.$bitmapWidth,u=this.$texture.$bitmapHeight,d=this.$texture.$sourceWidth,c=this.$texture.$sourceHeight,p=h/d,f=o?u/d:l/d,g=a/c,y=o?l/c:u/c,n=0,$=0,s=r.length;s>n;++n,$+=2){var x=r[n],_=i[$],v=i[$+1];x.x=e[$],x.y=-e[$+1],x.z=this._bkNode.zOrder,x.r=1,x.g=1,x.b=1,x.a=1,o?(x.u=p+(1-v)*f,x.v=1-(g+_*y)):(x.u=p+_*f,x.v=1-(g+v*y))}}else for(var n=0,$=0,s=r.length;s>n;++n,$+=2){var x=r[n];x.x=e[$],x.y=-e[$+1]}this._bkMesh.setVerticesAndIndices(r,t.indices)}if(this._transformDirty||this.$matrixDirty){this._transformDirty=!1;var b=this.$getMatrix(),T=this._bkNode.transform.matrix,m=b.tx,B=b.ty,S=this.$anchorOffsetX,F=this.$anchorOffsetY;(0!==S||0!==F)&&(m-=b.a*S+b.c*F,B-=b.b*S+b.d*F),T.set(b.a,-b.b,-b.c,b.d,m,-B)}return this._bkNode},i}(t.BKDisplayObject);t.BKMesh=e,__reflect(e.prototype,"egret.BKMesh"),t.Mesh=e}(egret||(egret={}));var egret;!function(t){function e(t,e){for(var i=Object.getOwnPropertyNames(t),r=function(i){Object.defineProperty(e,i,{get:function(){return t[i]},set:function(e){t[i]=e}})},n=0,s=i;n<s.length;n++){var o=s[n];r(o)}}function i(t){for(var e=new ArrayBuffer(t.bufferLength()),i=new Uint8Array(e),r=0;r<t.bufferLength()-1;){var n=t.readUint8Buffer();i[r++]=n}return e}t.emptyTexture=new BK.Texture("GameRes://resource/empty.png"),t.defineProxyProperties=e,t.bricksBufferToArrayBuffer=i}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(e,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*e+r.c*i+r.tx,s=r.b*e+r.d*i+r.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,s))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null;for(var h=this.$children,a=!1,l=null,u=h.length-1;u>=0;u--){var d=h[u];if(!d.$maskedObject&&(l=d.$hitTest(e,i))){if(a=!0,l.$touchEnabled)break;l=null}}return l?this.$touchChildren?l:this:a?this:(l=t.DisplayObject.prototype.$hitTest.call(this,e,i),l&&(l=this.$graphics.$hitTest(e,i)),l)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.BKDisplayObjectContainer);t.BKSprite=e,__reflect(e.prototype,"egret.BKSprite"),t.Sprite=e}(egret||(egret={}));var egret;!function(t){function e(e,i,r){r=r||{};var n=null==r.italic?i[16]:r.italic,s=null==r.bold?i[15]:r.bold,o=null==r.size?i[0]:r.size,h=r.fontFamily||i[8]||t.TextField.default_fontFamily;return t.sys.measureText(e,h,o,s,n)}function i(t,e,i,r,n){return s||(s=new BK.TextNode(o,"")),o.fontSize=i,o.bold=r?1:0,o.italic=n?1:0,s.updateText(o,t),s.width}var r=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![。，！、》…）)}”】\\.\\,\\!\\?\\]\\:])"),n=function(i){function n(){var e=i.call(this,new BK.TextNode({},""))||this;return e.$inputEnabled=!1,e.inputUtils=null,e.graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1,e._style={fontSize:t.TextField.default_size,textColor:t.TextField.default_textColor+4278190080,maxWidth:512,maxHeight:64,width:512,height:64,textAlign:0,bold:0,italic:0,strokeColor:0,strokeSize:0,shadowRadius:0,shadowDx:0,shadowDy:0,shadowColor:0},e._bkText=e._bkNode,e.$TextField={0:t.TextField.default_size,1:0,2:t.TextField.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:t.TextField.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT},e.$TextField[1]=10,e}return __extends(n,i),n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){i.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(t){var e=this.$TextField;return e[8]==t?!1:(e[8]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(t){t=+t||0;var e=this.$TextField;return e[0]==t?!1:(e[0]=t,this.invalidateFontString(),this._transformDirty=!0,this._style.fontSize=t,!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(t){t=!!t;var e=this.$TextField;return t==e[15]?!1:(e[15]=t,this.invalidateFontString(),this._transformDirty=!0,this._style.bold=t?1:0,!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(t){t=!!t;var e=this.$TextField;return t==e[16]?!1:(e[16]=t,this.invalidateFontString(),this._transformDirty=!0,this._style.italic=t?1:0,!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(e){var i=this.$TextField;if(i[9]==e)return!1;switch(i[9]=e,this.$invalidateTextField(),this._transformDirty=!0,e){case t.HorizontalAlign.LEFT:this._style.textAlign=0;break;case t.HorizontalAlign.CENTER:this._style.textAlign=1;break;case t.HorizontalAlign.RIGHT:this._style.textAlign=2}return!0},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(t){var e=this.$TextField;return e[10]==t?!1:(e[10]=t,this.$invalidateTextField(),this._transformDirty=!0,!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(t){t=+t||0;var e=this.$TextField;return e[1]==t?!1:(e[1]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(t){t=0|+t;var e=this.$TextField;if(e[2]==t)return!1;e[2]=t,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField();var i=this._refitString(t,6),r=this._refitString(this._style.textColor,8),n=r.substring(0,2)+i,s=parseInt(n,16);return this._style.textColor=s,!0},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(t){t=!!t;var e=this.$TextField;t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField()))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var i=this.$TextField;return i[24]!=e?(i[24]=e,e==t.TextFieldType.INPUT?(isNaN(i[3])&&this.$setWidth(100),isNaN(i[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(t){this.$TextField[37]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)
},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(t){null==t&&(t=""),t=t.toString(),this.isFlow=!1;var e=this.$TextField;if(e[13]!=t){this.$invalidateTextField(),e[13]=t;var i="";return i=e[20]?this.changeToPassText(t):t,this.setMiddleStyle([{text:i}]),this._transformDirty=!0,!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(t){var e=this.$TextField;if(e[20]!=t){e[20]=t,this.$invalidateTextField();var i="";return i=t?this.changeToPassText(e[13]):e[13],this.setMiddleStyle([{text:i}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){t=+t||0,this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var i=this.$TextField;if(i[25]!=e){this.$invalidateTextField(),i[25]=e,i[26]=t.toColorString(e);var r=this._refitString(e,6),n=this._refitString(this._style.strokeColor,8),s=n.substring(0,2)+r,o=parseInt(s,16);return this._style.strokeColor=o,!0}return!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(t){return this.$TextField[27]!=t?(this.$invalidateTextField(),this.$TextField[27]=t,this._transformDirty=!0,this._style.strokeSize=t,!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(t){return this.$TextField[21]!=t?(this.$TextField[21]=t,!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(t){this.$TextField[28]=Math.max(t,1),this.$invalidateTextField()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(t){return this.$TextField[30]=t,this.$invalidateTextField(),!0},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&(i=t.indexOf("^",i),0!=i)&&i>0&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):i>0?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[3]))return!1;e[3]=0/0}else{if(e[3]==t)return!1;e[3]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),this._transformDirty=!0,this._style.width=this._style.maxWidth=e[3],!0)},n.prototype.$setHeight=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[4]))return!1;e[4]=0/0}else{if(e[4]==t)return!1;e[4]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),this._transformDirty=!0,this._style.height=this._style.maxHeight=e[4],!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(t){this.$TextField[31]=!!t},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(t){this.$TextField[32]=+t||0},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(t){this.$TextField[33]=t},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(t){this.$TextField[34]=t},n.prototype.fillBackground=function(e){var i=this.graphicsNode;i&&i.clear();var r=this.$TextField;if(r[33]||r[31]||e&&e.length>0){if(!i){i=this.graphicsNode=new t.sys.GraphicsNode;var n=new t.sys.GroupNode;n.addNode(i),n.addNode(this.textNode),this.$renderNode=n}var s=void 0,o=void 0;if(r[33]&&(s=i.beginFill(r[34]),s.drawRect(0,0,this.$getWidth(),this.$getHeight())),r[31]&&(o=i.lineStyle(1,r[32]),o.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var h=r[2],a=-1,l=e.length,u=0;l>u;u+=4){var d=e[u],c=e[u+1],p=e[u+2],f=e[u+3]||h;(0>a||a!=f)&&(a=f,o=i.lineStyle(2,f,1,t.CapsStyle.NONE)),o.moveTo(d,c),o.lineTo(d+p,c)}}if(i){var g=this.$getRenderBounds();i.x=g.x,i.y=g.y,i.width=g.width,i.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&this.textNode.clean()},n.prototype.$onAddToStage=function(e,r){i.prototype.$onAddToStage.call(this,e,r),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){var t=this;t.$renderDirty=!0,t.$TextField[18]=!0},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),i=t.Rectangle.create();i.copyFrom(e),this.$TextField[31]&&(i.width+=2,i.height+=2);var r=2*this.$TextField[27];return r>0&&(i.width+=2*r,i.height+=2*r),i.x-=r+2,i.y-=r+2,i.width=Math.ceil(i.width)+4,i.height=Math.ceil(i.height)+4,i},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var i=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],r=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4];e.setTo(0,0,i,r)},n.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.graphicsNode;return void(e&&e.clear())}var i=this.drawText();this.fillBackground(i);var r=this.$getRenderBounds(),n=this.textNode;n.x=r.x,n.y=r.y,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),t.Rectangle.release(r)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0;var e="";null==t&&(t=[]);for(var i=0;i<t.length;i++){var r=t[i];e+=r.text}this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.setMiddleStyle(t))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;r>i;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(t){var e=this.$TextField[13]+t.text;this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.textArr.push(t),this.setMiddleStyle(this.textArr))},n.prototype.$getLinesArr=function(){var i=this.$TextField;if(!i[18])return this.linesArr;i[18]=!1;var n=this.textArr;this.linesArr.length=0,i[6]=0,i[5]=0;var s=i[3];if(!isNaN(s)&&0==s)return i[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var o,h=this.linesArr,a=0,l=0,u=0,d=0,c=0,p=n.length;p>c;c++){var f=n[c];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),y=g.split(/(?:\r\n|\r|\n)/),$=0,x=y.length;x>$;$++){null==h[d]&&(o={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},h[d]=o,a=0,u=0,l=0),u=i[24]==t.TextFieldType.INPUT?i[0]:Math.max(u,f.style.size||i[0]);var _=!0;if(""==y[$])$==x-1&&(_=!1);else{var v=e(y[$],i,f.style);if(isNaN(s))a+=v,l+=y[$].length,o.elements.push({width:v,text:y[$],style:f.style}),$==x-1&&(_=!1);else if(s>=a+v)o.elements.push({width:v,text:y[$],style:f.style}),a+=v,l+=y[$].length,$==x-1&&(_=!1);else{var b=0,T=0,m=y[$],B=void 0;B=i[19]?m.split(r):m.match(/./g);for(var S=B.length,F=0;S>b;b++){var C=B[b].length,k=!1;if(1==C&&S-1>b){var w=B[b].charCodeAt(0),O=B[b+1].charCodeAt(0);if(w>=55296&&56319>=w&&56320==(64512&O)){var N=B[b]+B[b+1];C=2,k=!0,v=e(N,i,f.style)}else v=e(B[b],i,f.style)}else v=e(B[b],i,f.style);if(0!=a&&a+v>s&&a+b!=0)break;if(T+v>s)for(var E=B[b].match(/./g),P=0,R=E.length;R>P;P++){var C=E[P].length,K=!1;if(1==C&&R-1>P){var w=E[P].charCodeAt(0),O=E[P+1].charCodeAt(0);if(w>=55296&&56319>=w&&56320==(64512&O)){var N=E[P]+E[P+1];C=2,K=!0,v=e(N,i,f.style)}else v=e(E[P],i,f.style)}else v=e(E[P],i,f.style);if(P>0&&a+v>s)break;F+=C,T+=v,a+=v,l+=F,K&&P++}else F+=C,T+=v,a+=v,l+=F;k&&b++}if(b>0){o.elements.push({width:T,text:m.substring(0,F),style:f.style});var A=m.substring(F),D=void 0,M=A.length;for(D=0;M>D&&" "==A.charAt(D);D++);y[$]=A.substring(D)}""!=y[$]&&($--,_=!1)}}_&&(l++,o.hasNextLine=!0),$<y.length-1&&(o.width=a,o.height=u,o.charNum=l,i[5]=Math.max(i[5],a),i[6]+=u,d++)}c==n.length-1&&o&&(o.width=a,o.height=u,o.charNum=l,i[5]=Math.max(i[5],a),i[6]+=u)}else o&&(o.width=a,o.height=u,o.charNum=l,i[5]=Math.max(i[5],a),i[6]+=u)}return i[29]=h.length,h},n.prototype.drawText=function(){var e=this.$TextField,i=this.$getLinesArr();if(0==e[5])return[];var r=isNaN(e[3])?e[5]:e[3],n=t.TextFieldUtils.$getTextHeight(this),s=0,o=t.TextFieldUtils.$getStartLine(this),h=e[4];if(!isNaN(h)&&h>n){var a=t.TextFieldUtils.$getValign(this);s+=a*(h-n)}s=Math.round(s);for(var l=t.TextFieldUtils.$getHalign(this),u=0,d=[],c=o,p=e[29];p>c;c++){var f=i[c],g=f.height;if(s+=g/2,c!=o){if(e[24]==t.TextFieldType.INPUT&&!e[30])break;if(!isNaN(h)&&s>h)break}u=Math.round((r-f.width)*l);for(var y=0,$=f.elements.length;$>y;y++){var x=f.elements[y];x.style.size||e[0];x.style.underline&&d.push(u,s+g/2,x.width,x.style.textColor),u+=x.width}s+=g/2+e[1]}return d},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(t){},n.prototype._refitString=function(t,e){var i=t.toString(16),r="00000000";return r.substr(0,e-i.length)+i},n.prototype.$getRenderNode=function(){if(this.$renderDirty){if(this.$renderDirty=!1,this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.graphicsNode;return void(e&&e.clear())}var i=this.drawText();this.fillBackground(i);var r=this.$getRenderBounds();this._style.width=this._style.maxWidth=Math.ceil(r.width),this._style.height=this._style.maxHeight=Math.ceil(r.height),t.Rectangle.release(r),this._bkText.updateText(this._style,this.$TextField[13])}if(this._transformDirty||this.$matrixDirty){this._transformDirty=!1;var n=this.$getMatrix(),s=this._bkNode.transform.matrix,o=this._bkText.size,h=n.tx,a=n.ty,l=this.$anchorOffsetX,u=this.$anchorOffsetY-o.height;switch((0!==l||0!==u)&&(h-=n.a*l+n.c*u,a-=n.b*l+n.d*u),this.$TextField[9]){case t.HorizontalAlign.LEFT:break;case t.HorizontalAlign.CENTER:h-=.5*(o.width-this.$getWidth());break;case t.HorizontalAlign.RIGHT:h-=o.width-this.$getWidth()}switch(this.$TextField[10]){case t.VerticalAlign.TOP:break;case t.VerticalAlign.MIDDLE:a+=.5*(o.height-this._bkText.height);break;case t.VerticalAlign.BOTTOM:a+=o.height-this._bkText.height}s.set(n.a,-n.b,-n.c,n.d,h,-a)}return this._bkNode},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.BKDisplayObject);t.BKTextField=n,__reflect(n.prototype,"egret.BKTextField");var s,o={fontSize:t.TextField.default_size,textColor:t.TextField.default_textColor+4278190080,maxWidth:1280,maxHeight:512,width:1280,height:512,textAlign:0,bold:0,italic:0,strokeColor:0,strokeSize:0,shadowRadius:0,shadowDx:0,shadowDy:0,shadowColor:0};t.sys.measureText=i,t.TextField=n}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.type=t.Sound.EFFECT,i}return __extends(i,e),i.prototype.load=function(e){this.url=e,BK.FileUtil.isFileExist(this.url)?t.$callAsync(t.Event.dispatchEvent,t.Event,this,t.Event.COMPLETE):t.$callAsync(t.Event.dispatchEvent,t.IOErrorEvent,this,t.IOErrorEvent.IO_ERROR)},i.prototype.play=function(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r=new t.BKSoundChannel;return r.$loops=i,r.$startTime=e,r.$type=this.type,r.$url=this.url,r.$play(),r},i.prototype.close=function(){},i.MUSIC="music",i.EFFECT="effect",i}(t.EventDispatcher);t.BKSound=e,__reflect(e.prototype,"egret.BKSound",["egret.Sound"]),t.Sound=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.$play=function(){var e;switch(this.$type){case t.Sound.MUSIC:e=0;break;case t.Sound.EFFECT:e=1}var i=0===this.$loops?-1:this.$loops,r="GameRes://"+this.$url;this._bkAudio=new BK.Audio(e,r,i,0),this._bkAudio.startMusic()},i.prototype.stop=function(){this._bkAudio.stopMusic()},i}(t.EventDispatcher);t.BKSoundChannel=e,__reflect(e.prototype,"egret.BKSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}var i=function(){function i(){this.lastX=0,this.lastY=0,this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=0,this.lineWidth=0,this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.includeLastPosition=!0;var e=t.lifecycle.stage;this.stageW=e.stageWidth,this.stageH=e.stageHeight,this._BKCanvas=new BK.Canvas(2*this.stageW,2*this.stageH),this._BKCanvas.position={x:-this.stageW,y:-this.stageH},this.offsetX=this.stageW,this.offsetY=this.stageH,this._BKCanvas.backgroundColor={r:0,g:0,b:0,a:0}}return i.prototype.$setTarget=function(t){this.targetDisplay&&(this.targetDisplay.$renderNode=null),t._bkNode.addChild(this._BKCanvas),this.targetDisplay=t},i.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},i.prototype.beginFill=function(t,e){void 0===e&&(e=1),t=+t||0,e=+e||0,this.isFillPath=!0;var i=this._refitString(t,6),r=parseInt(i.substring(0,2),16)/255,n=parseInt(i.substring(2,4),16)/255,s=parseInt(i.substring(4,6),16)/255;this._BKCanvas.fillColor={r:r,g:n,b:s,a:e}},i.prototype._refitString=function(t,e){var i=t.toString(16),r="00000000";return r.substr(0,e-i.length)+i},i.prototype.beginGradientFill=function(t,e,i,r,n){void 0===n&&(n=null)},i.prototype.endFill=function(){this.isFillPath&&(this._BKCanvas.fill(),this.isFillPath=!1),this.isStrokePath&&(this._BKCanvas.stroke(),this._BKCanvas.closePath(),this.isStrokePath=!1)},i.prototype.lineStyle=function(t,e,i,r,n,s,o,h,a){if(void 0===t&&(t=0/0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=!1),void 0===n&&(n="normal"),void 0===s&&(s=null),void 0===o&&(o=null),void 0===h&&(h=3),0>=t)this.isStrokePath=!1,this.lineWidth=0,this.setStrokeWidth(0);else{e=+e||0,i=+i||0,this.setStrokeWidth(t),this.lineWidth=t,this._BKCanvas.lineWidth=t,this.isStrokePath=!0;var l=this._refitString(e,6),u=parseInt(l.substring(0,2),16)/255,d=parseInt(l.substring(2,4),16)/255,c=parseInt(l.substring(4,6),16)/255;this._BKCanvas.strokeColor={r:u,g:d,b:c,a:i}}},i.prototype.drawRect=function(t,e,i,r){var n=+t+this.offsetX||0,s=-e+this.offsetY||0;i=+i||0,r=+r||0,this.extendBoundsByPoint(t+i,e+r),this.updatePosition(t,e),this.isFillPath&&this._BKCanvas.fillRect(n,s-r,i,r),this.isStrokePath&&this._BKCanvas.strokeRect(n,s-r,i,r)},i.prototype.drawRoundRect=function(t,e,i,r,n,s){this.offsetX+t||0,this.offsetY-e||0;i=+i||0,r=+r||0,n=+n||0,s=+s||0,this.roundRect(t,e,i,r,n,s);var o=.5*n|0,h=s?.5*s|0:o,a=t+i,l=e+r,u=l-h;this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(a,l),this.updatePosition(a,u)},i.prototype.roundRect=function(t,e,i,r,n,s){var o=.5*n|0,h=s?.5*s|0:o;if(!o||!h)return void this.drawRect(t,e,i,r);var a=.5*i,l=.5*r;if(o>a&&(o=a),h>l&&(h=l),a===o&&l===h)return void(o===h?this.drawCircle(t+o,e+h,o):this.drawEllipse(t,e,2*o,2*h));var u=t+i,d=e+r,c=t+o,p=u-o,f=e+h,g=d-h;this.moveTo(u,g),this.curveTo(u,d,p,d),this.lineTo(c,d),this.curveTo(t,d,t,g),this.lineTo(t,f),this.curveTo(t,e,c,e),this.lineTo(p,e),this.curveTo(u,e,u,f),this.lineTo(u,g)},i.prototype.drawCircle=function(t,e,i){var r=+t+this.offsetX||0,n=-e+this.offsetY||0;i=+i||0,this._BKCanvas.drawCircle(r,n,i),this.isStrokePath&&this.isFillPath&&(this._BKCanvas.fill(),this._BKCanvas.drawCircle(r,n,i),this._BKCanvas.stroke()),this.extendBoundsByPoint(t-i-1,e-i-1),this.extendBoundsByPoint(t+i+2,e+i+2),this.updatePosition(t+i,e)},i.prototype.drawEllipse=function(t,e,i,r){var n=+t+this.offsetX||0,s=-e+this.offsetY||0;i=+i||0,r=+r||0,this._BKCanvas.drawEllipse(n,s,i,r),this.isStrokePath&&this.isFillPath&&(this._BKCanvas.fill(),this._BKCanvas.drawEllipse(n,s,i,r),this._BKCanvas.stroke()),this.extendBoundsByPoint(t-1,e-1),this.extendBoundsByPoint(t+i+2,e+r+2),this.updatePosition(t+i,e+.5*r)},i.prototype.moveTo=function(t,e){var i=t+this.offsetX||0,r=-e+this.offsetY||0;this._BKCanvas.moveTo(i,r)},i.prototype.lineTo=function(t,e){var i=t+this.offsetX||0,r=-e+this.offsetY||0;this._BKCanvas.lineTo(i,r),this.updatePosition(t,e)},i.prototype.curveTo=function(t,e,i,r){var n=this.offsetX+t||0,s=this.offsetY-e||0,o=this.offsetX+i||0,h=this.offsetY-r||0;this._BKCanvas.quadraticCurveTo(n,s,o,h),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.updatePosition(i,r)},i.prototype.cubicCurveTo=function(t,e,i,r,n,s){var o=this.offsetX+t||0,h=this.offsetY-e||0,a=this.offsetX+i||0,l=this.offsetY-r||0,u=this.offsetX+n||0,d=this.offsetY-s||0;this._BKCanvas.bezierCurveTo(o,h,a,l,u,d),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.extendBoundsByPoint(n,s),this.updatePosition(n,s)},i.prototype.drawArc=function(t,i,r,n,s,o){if(!(0>r||n===s)){var h=this.offsetX+t||0,a=this.offsetY-i||0;r=+r||0,n=+n||0,s=+s||0,o=!!o;var l=e(-s),u=e(n);this._BKCanvas.arc(h,a,r,l,u,o),this.isStrokePath&&this.isFillPath&&(this._BKCanvas.fill(),this._BKCanvas.arc(h,a,r,l,u,o),this._BKCanvas.stroke());var d=t+Math.cos(s)*r,c=i+Math.sin(s)*r;this.updatePosition(d,c)}},i.prototype.clear=function(){this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this._BKCanvas.clearRect(0,0,2*this.stageW,2*this.stageH),this.isFillPath=!1,this.isStrokePath=!1},i.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},i.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.updateNodeBounds=function(){},i.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},i.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},i.prototype.$hitTest=function(t,e){return this._BKCanvas.hittest({x:t,y:e})?this.targetDisplay:null},i.prototype.$onRemoveFromStage=function(){},i}();t.BKGraphics=i,__reflect(i.prototype,"egret.BKGraphics"),t.Graphics=i}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i;!function(e){function i(t){if(BK.FileUtil.isFileExist(o)){var e=BK.FileUtil.readFile(o).readAsString();if(e){var i=JSON.parse(e);return i?i[t]:void 0}}}function r(t,e){var i=BK.FileUtil.readFile(o).readAsString(),r={};if(i){var n=JSON.parse(i);n&&(r=n)}r[t]=e;var s=JSON.stringify(r);return BK.FileUtil.writeFile(o,s),!0}function n(t){var e=BK.FileUtil.readFile(o).readAsString();if(e){var i=JSON.parse(e);if(i&&i[t]){delete i[t];var r=JSON.stringify(i);BK.FileUtil.writeFile(o,r)}}}function s(){if(BK.FileUtil.isFileExist(o)){var t={},e=JSON.stringify(t);BK.FileUtil.writeFile(o,e)}}var o="GameSandBox://resource/localStorage";t.localStorage.setItem=r,t.localStorage.getItem=i,t.localStorage.removeItem=n,t.localStorage.clear=s}(i=e.BKlocalStorage||(e.BKlocalStorage={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$stageWidth=0,i.$stageHeight=0,i.$scaleMode=t.StageScaleMode.SHOW_ALL,i.$orientation=t.OrientationMode.AUTO,i.$maxTouches=99,i.$stage=i,i.$nestLevel=1,i}return __extends(i,e),Object.defineProperty(i.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),i.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},i.prototype.registerImplementation=function(e,i){t.registerImplementation(e,i)},i.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(i.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dirtyRegionPolicy",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},i}(t.BKDisplayObjectContainer);t.BKStage=e,__reflect(e.prototype,"egret.BKStage"),t.Stage=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(r){var n=e.call(this)||this;n.stage=new t.Stage,n._mainTicker=BK.Director.ticker,n._viewRect=new t.Rectangle,n._touch=new t.sys.TouchHandler(n.stage),n._displayList=[],i.instance=n,n._options=r,BK.Director.root.addChild(n.stage._bkNode),t.lifecycle.stage=n.stage,t.sys.$TempStage=n.stage,n.stage.$screen=n,n.stage.maxTouches=10,n.stage.frameRate=n._options.frameRate,n.stage.orientation=n._options.orientation,n.stage.scaleMode=n._options.scaleMode,n._mainTicker.add(function(){n._touchHandler(),t.ticker.update(),t.ticker.callLaters();for(var e=0,i=n._displayList;e<i.length;e++){var r=i[e];r.$getRenderNode()}},n),n.updateScreenSize(),n.updateMaxTouches();var s,o=n._options.entryClassName;if(o&&(s=t.getDefinitionByName(o)),s){var h=new s;h instanceof t.DisplayObject&&n.stage.addChild(h)}return n}return __extends(i,e),i.prototype._touchHandler=function(){var t=BK.TouchEvent.getTouchEvent();if(t&&0!==t.length){for(var e=0,i=t;e<i.length;e++){var r=i[e],n=r.id,s=(BK.Director.screenPixelSize,BK.Director.root.convertToNodeSpace(r)),o=s.x,h=-s.y;1===r.status?this._touch.onTouchEnd(o,h,n):2===r.status?this._touch.onTouchBegin(o,h,n):3===r.status&&this._touch.onTouchMove(o,h,n)}BK.TouchEvent.updateTouchStatus()}},i.prototype.updateScreenSize=function(){var e=BK.Director.screenPixelSize,i=e.width,r=e.height;t.Capabilities.$boundingClientWidth=i,t.Capabilities.$boundingClientHeight=r;var n=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,i,r,this._options.contentWidth,this._options.contentHeight),s=n.stageWidth,o=n.stageHeight,h=n.displayWidth,a=n.displayHeight,l=(r-a)/2,u=(i-h)/2;this.stage.$stageWidth=s,this.stage.$stageHeight=o,BK.Director.root.position={x:u,y:BK.Director.screenPixelSize.height-l},BK.Director.root.scale={x:h/s,y:a/o},this._viewRect.setTo(u,l,s,o),this.stage.dispatchEventWith(t.Event.RESIZE)},i.prototype.setContentSize=function(t,e){var i=this._options;i.contentWidth=t,i.contentHeight=e,this.updateScreenSize()},i.prototype.updateMaxTouches=function(){this._touch.$initMaxTouches()},i}(t.HashObject);t.BKPlayer=e,__reflect(e.prototype,"egret.BKPlayer",["egret.sys.Screen"])}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.textValue="",t.onKeyboardComplete=t.onKeyboardComplete.bind(t),t.onKeyboardInput=t.onKeyboardInput.bind(t),t}return __extends(i,e),i.prototype.$setTextField=function(t){return this.$textfield=t,!0},i.prototype.$addToStage=function(){},i.prototype.$show=function(){BK.Editor.showKeyBoard(this.onKeyboardComplete,this.onKeyboardInput),this.dispatchEvent(new t.Event("focus"))},i.prototype.onKeyboardInput=function(e){this.textValue=e,t.Event.dispatchEvent(this,"updateText",!1)},i.prototype.onKeyboardComplete=function(t){this.$textfield.text=t,this.$hide()},i.prototype.$hide=function(){this.dispatchEvent(new t.Event("blur"))},i.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},i.prototype.$setText=function(t){return this.textValue=t,!0},i.prototype.$setColor=function(t){return!0},i.prototype.$onBlur=function(){},i.prototype.$removeFromStage=function(){},i.prototype.$resetStageText=function(){},i}(t.EventDispatcher);t.BKHTML5StageText=e,__reflect(e.prototype,"egret.BKHTML5StageText",["egret.StageText"]),t.StageText=e}(egret||(egret={})),console=console||{},console.warn=console.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i="";if(t)for(var r=0,n=t;r<n.length;r++){var s=n[r];i+=" "+s}BK.Script.log(0,0,i)},console.assert=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];t||console.log.apply(null,e)};var egret;!function(t){function e(t,e,i){BK.Director.ticker.setTimeout(t,i,e)}function i(t){BK.Director.ticker.removeTimeout(t)}function r(e){h||(h=!0,n(),s(),e||(e={}),e.screenAdapter?t.sys.screenAdapter=e.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter),t.sys.systemRenderer=new t.BKSystemRenderer,t.sys.canvasRenderer=new t.BKSystemRenderer,o=new t.BKPlayer(e))}function n(){}function s(){"undefined"!=typeof eui&&(Object.defineProperty(eui.Image.prototype,"scale9Grid",{set:function(t){this.$setScale9Grid(t),this.invalidateDisplayList()},enumerable:!0,configurable:!0}),eui.Image.prototype.$getRenderNode=function(){var t=this.$bitmapData;if(!t)return null;var e=this.$UIComponent,i=e[10],r=e[11];if(0===i||0===r)return null;if(this._transformDirty||this.$matrixDirty){this._transformDirty=!1,this._size.width=this.$getWidth(),this._size.height=this.$getHeight(),this._bkSprite.size=this._size;var n=this.$getMatrix(),s=this._bkNode.transform.matrix,o=n.tx,h=n.ty,a=this.$anchorOffsetX,l=this.$anchorOffsetY-this._size.height;(0!==a||0!==l)&&(o-=n.a*a+n.c*l,h-=n.b*a+n.d*l),s.set(n.a,-n.b,-n.c,n.d,o,-h)}return this._bkNode}),void 0!==typeof t.WebSocket&&(t.ISocket=t.BKSocket)}t.getTimer=function(){return Math.round(1e3*BK.Time.timestamp)},t.setTimeout=e,t.clearTimeout=i;var o,h=!1;t.runEgret=r}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),i.prototype.load=function(e){BK.FileUtil.isFileExist(e)?(this.data=new t.BitmapData(e),t.$callAsync(t.Event.dispatchEvent,t.Event,this,t.Event.COMPLETE)):t.$callAsync(t.Event.dispatchEvent,t.IOErrorEvent,this,t.IOErrorEvent.IO_ERROR)},i.crossOrigin=null,i}(t.EventDispatcher);t.BKImageLoader=e,__reflect(e.prototype,"egret.BKImageLoader",["egret.ImageLoader"]),t.ImageLoader=e}(egret||(egret={}));